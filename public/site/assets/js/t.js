!function(){window.PixelLab=window.PixelLab||{};var l={utils:{},controls:{},view:{},exports:window.PixelLab};l.utils.randomInt=function(t,i){return Math.floor(Math.random()*(i-t+1))+t},l.utils.debounce=function(s,o,n){var a;return function(){var t=this,i=arguments,e=n&&!a;clearTimeout(a),a=setTimeout(function(){a=null,n||s.apply(t,i)},o),e&&s.apply(t,i)}},function(){function t(t,i){this.$el=t,this.youtubeId=i,this.$host=this.$el.find(".youtube-host"),this.$play=this.$el.find(".youtube-play"),this.play()}t.prototype.play=function(){this.isPaused=!1;var t=this.$host,i=$('<iframe src="http://www.youtube.com/embed/'+this.youtubeId+'?autoplay=1&controls=1&color=white&modestbranding=1&showinfo=0&html5=1&enablejsapi=1" width="100%" height="100%" frameborder="0"></iframe>');this.frame=i[0],this.$host.fadeIn(300,function(){t.append(i)}),this.$play.fadeOut(200)},t.prototype.stop=function(){this.isPaused=!0,this.$play.fadeIn(200),this.$host.fadeOut(400,function(){$(this).empty()})},t.prototype.togglePause=function(){this.isPaused=!this.isPaused;var t=this.isPaused?"pauseVideo":"playVideo";this.frame.contentWindow.postMessage('{"event":"command","func":"'+t+'","args":""}',"*"),this.isPaused?this.$play.fadeIn(200):this.$play.fadeOut(200)},l.controls.YouTubePlayer=t}(),function(){l.utils.randomInt,window.requestAnimationFrame,window.cancelAnimationFrame;var e={buildings:{name:"buildings",x:119,y:184,z:.85},trees:{name:"trees",x:15,y:247,z:.65},windowbg:{name:"windowbg",x:280,y:290,z:0},lab:{name:"sprite-lab",x:355,y:358,z:0,w:99,h:65,frameCount:29,loopFrame:0},testtubes:{name:"sprite-testtubes",x:272,y:317,z:0,w:104,h:100,frameCount:103,loopFrame:0,actionFrame:48},lightning:{name:"lightning",x:971,y:99,z:1.15},logotext:{name:"logotext",x:308,y:125,z:1.15},pixellab:{name:"lab",x:42,y:271,z:0},discuss:{name:"sprite-discuss",x:1e3,y:500,z:-.5,w:138,h:114,frameCount:131,loopFrame:0},laptop:{name:"sprite-laptop",x:115,y:405,z:0,w:61,h:197,frameCount:38,loopFrame:0,actionFrame:13},thunder:{name:"sprite-thunder",x:970,y:16,z:1.15,w:108,h:192,frameCount:97,loopFrame:0,actionFrame:23},dog:{name:"sprite-dog",x:1139,y:588,z:-.5,w:91,h:67,frameCount:19,loopFrame:0,actionFrame:11,scale:.8}},t={init:function(){for(var t in this.elements=e,this.$window=$(window),this.scrollOffset=0,this.$window.on("scroll",$.proxy(this.scroll,this)),this.$canvas=$("#c"),this.canvas=this.$canvas[0],this.canvas.width=1366,this.canvas.height=660,this.ctx=this.canvas.getContext("2d"),this.elements){var i=e[t];i.isSprite="frameCount"in i,i.image=new Image,i.image.src="/img/lab/"+i.name+".png",i.isSprite&&(i.hasAction="actionFrame"in i,i.loopEnd=i.hasAction?i.actionFrame-1:i.frameCount,i.frame=0)}this.proxyLoop=$.proxy(this.loop,this),this.debounceStart=l.utils.debounce($.proxy(this.start,this),50),this.loaded=!1,this.frame=0,this.frameFlag=0,this.start()},start:function(){this.isPaused=!1,this.fps=20,this.loopId=setInterval($.proxy(function(){this.proxyLoop()},this),1e3/this.fps)},pause:function(){this.isPaused=!0,clearInterval(this.loopId)},loop:function(){if(this.frame++,5e3<=this.frame&&this.pause(),!this.loaded){for(var t in this.loaded=!0,this.elements)this.loaded=this.loaded&&this.elements[t].image.complete;this.loaded&&(this.$canvas.css("display","block"),setTimeout(function(){$("#welcome-graphics-container img").css("opacity",0)},50))}this.loaded&&this.render(!0)},render:function(t){for(var i in this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.elements){var e=this.elements[i];e.scrollY=e.y+this.scrollOffset*e.z,e.isSprite?(t&&e.frame++,e.frame===e.frameCount&&(e.frame=0),e.frame===e.loopEnd&&e.hasAction&&.35<Math.random()&&(e.frame=0),this.ctx.drawImage(e.image,e.w*e.frame,0,e.w,e.h,e.x,e.scrollY,e.w,e.h)):this.ctx.drawImage(e.image,e.x,e.scrollY)}},scroll:function(){this.pause(),this.scrollOffset=this.$window.scrollTop()/5,$("#welcome h2").css({top:-1.8*this.scrollOffset}),$("#welcome h3").css({top:-1.8*this.scrollOffset}),this.render(!1),this.debounceStart()}};l.controls.AnimatedHeader=t}(),function(){var s=0,o=1,n=2,e={slidesOuter:".slidesOuter",slidesInner:".slidesInner",slide:".slide",onSlidePositionChanged:null,onSlideChanged:null,onSlideTap:null,flickTiming:700,flickEasing:"easeOutExpo",minFlickDistance:100,minRelativeFlickDistance:.15,nextTiming:700,nextEasing:"easeOutExpo",enableArrowKeys:!1};function t(t,i){this.options=$.extend({},e,i),this.$document=$(document),this.$el=t,this.$slides=this.$el.find(this.options.slide),this.$outer=this.$el.find(this.options.slidesOuter),this.$inner=this.$el.find(this.options.slidesInner),this.slideCount=this.$slides.length,this.selectedIndex=-1,this.resize(),this.$inner.find("img").attr("draggable",!1),this.$inner.on("pxpointerstart",$.proxy(this.pointerStart,this)),this.$inner.on("pxtap",$.proxy(this.tap,this)),$(document).on("keydown",$.proxy(this.keyDown,this)),this.toggleArrowKeys(this.options.enableArrowKeys),$(window).resize(_.bind(this.resize,this)),this.isEnabled=!0}(l.controls.TouchSlider=t).prototype.resize=function(){this.slideWidth=this.$outer.width(),this.$inner.css("width",this.slideWidth*this.slideCount),this.$inner.css("opacity",1),this.$slides.css("width",this.slideWidth),this.moveToSlide(this.selectedIndex,0,null)},t.prototype.slidePositionChanged=function(t){if(this.options.onSlidePositionChanged){var i=t/this.slideWidth,e=Math.floor(i),s=i-e;this.options.onSlidePositionChanged.call(this,{index:e,percent:s})}},t.prototype.moveToSlide=function(t,i,e){i=void 0===i?this.options.nextTiming:i,e=void 0===e?this.options.nextEasing:e,t=Math.max(t,0);var s=(t=Math.min(t,this.slideCount-1))!==this.selectedIndex,o=this.slideOffset,n=this.slideWidth*t-this.slideOffset;this.slideOffset=this.slideWidth*t,this.selectedIndex=t;var a=e?$.easing[e]:$.easing.linear,l=0;i?(this.isAnimationInProgress=!0,this.$inner.stop().animate({left:-1*this.slideOffset},{duration:i,easing:e,progress:$.proxy(function(t,i){l=a(null,i,o,n,1),this.slidePositionChanged(l)},this),complete:$.proxy(function(){this.isAnimationInProgress=!1},this)})):this.$inner.stop().css({left:-1*this.slideOffset}),s&&this.options.onSlideChanged&&this.options.onSlideChanged.call(this,t)},t.prototype.next=function(){this.moveToSlide(this.selectedIndex+1,this.options.nextTiming,this.options.nextEasing)},t.prototype.prev=function(){this.moveToSlide(this.selectedIndex-1,this.options.nextTiming,this.options.nextEasing)},t.prototype.flickToNearest=function(){var t=this.slideOffset/this.slideWidth-this.selectedIndex,i=t*this.slideWidth,e=Math.abs(t)>this.options.minRelativeFlickDistance||Math.abs(i)>this.options.minFlickDistance?this.selectedIndex+(0<i?1:-1):this.selectedIndex;this.moveToSlide(e,this.options.flickTiming,this.options.flickEasing)},t.prototype.pointerStart=function(t){if(!this.isEnabled)return!1;this.startOffset=this.slideOffset,this.startX=t.pointer.x,this.startY=t.pointer.y,this.pointerDirection=s,this.$document.on("pxpointermove",$.proxy(this.pointerMove,this)),this.$document.on("pxpointerend",$.proxy(this.pointerEnd,this))},t.prototype.pointerMove=function(t){var i=t.pointer.x-this.startX,e=t.pointer.y-this.startY;this.pointerDirection===s&&(10<Math.abs(i)?this.pointerDirection=n:10<Math.abs(e)&&(this.pointerDirection=o)),this.pointerDirection===n&&(t.preventDefault(),this.slideOffset=this.startOffset-i,this.$inner.stop().css({left:-1*this.slideOffset},0),this.slidePositionChanged(this.slideOffset))},t.prototype.pointerEnd=function(t){this.$document.off("pxpointermove",this.pointerMove,this),this.$document.off("pxpointerend",this.pointerEnd,this),this.flickToNearest()},t.prototype.tap=function(){this.options.onSlideTap&&this.options.onSlideTap.call(this,this.selectedIndex),this.$document.off("pxpointermove",this.pointerMove,this),this.$document.off("pxpointerend",this.pointerEnd,this)},t.prototype.toggleArrowKeys=function(t){t=void 0===t?!this.enableArrowKeys:t,this.enableArrowKeys=t},t.prototype.keyDown=function(t){if(this.enableArrowKeys&&this.isEnabled)switch(t.keyCode){case 37:this.prev();break;case 39:this.next()}}}(),function(){function t(t){this.$el=t,this.$nav=this.$el.find(".detail-slides-navselector"),this.$thumbs=this.$el.find(".detail-thumb"),this.$badge=this.$el.find(".detail-badge"),this.$close=this.$el.find(".detail-close");var i=this.slider=new l.controls.TouchSlider(this.$el,{onSlideChanged:$.proxy(function(t){this.$nav.children().removeClass("selected").eq(t).addClass("selected"),this.youtubePlayer&&(this.youtubePlayer.stop(),this.youtubePlayer=null)},this),onSlidePositionChanged:$.proxy(function(t){this.$badge&&(!this.badgeVisible&&0===t.index&&t.percent<.5?(this.$badge.fadeIn(400),this.badgeVisible=!0):(this.badgeVisible&&0<t.index||this.badgeVisible&&0===t.index&&.5<=t.percent)&&(this.$badge.fadeOut(400),this.badgeVisible=!1))},this),onSlideTap:$.proxy(this.playVideo,this)});$(".detail-slide-video").on("click",$.proxy(function(t){var i=$(t.target).closest(".detail-slide-video").index();this.playVideo(i)},this)),this.$nav.children().on("click",function(){i.moveToSlide($(this).index())}),this.$thumbs.on("click",function(){i.moveToSlide($(this).index())})}t.prototype.show=function(t){var i=$("#details"),e=$("#details-overlay");this.closeCallback=t,e.on("click",$.proxy(function(t){this.hide(i,e)},this)),$(document).on("keydown",$.proxy(function(t){this.hide(i,e)},this)),this.$close.on("click",$.proxy(function(t){this.hide(i,e)},this)),this.$el.siblings().hide(),this.$el.css("top",Math.max(($(window).height()-this.$el.height())/2,0)).show(),i.fadeTo(0,0,$.proxy(function(){this.slider.resize(),i.fadeTo(300,1)},this))},t.prototype.hide=function(t,i){this.youtubePlayer&&this.youtubePlayer.stop(),i.off("click",this.hide),t.fadeOut(),this.closeCallback&&this.closeCallback.call()},t.prototype.playVideo=function(t){var i=$(this.slider.$slides[t]),e=i.data("youtubeid");e&&(this.youtubePlayer?this.youtubePlayer.togglePause():this.youtubePlayer=new l.controls.YouTubePlayer(i,e))},l.controls.WorkDetail=t}(),function(){var e=[],s=function(t){t.preventDefault()},o=function(t){var i=$("body");t?i.css({overflow:"auto"}).off("scroll",s):i.css({overflow:"hidden"}).on("scroll",s)};l.controls.AnimatedHeader.init(),$("#header-menu li a").click(function(t){var i=$(t.target).attr("href");$("html, body").animate({scrollTop:$(i).offset().top-$("header").height()},750,"easeInOutQuart"),t.preventDefault()});var n=-1;$(window).scroll(function(t){var i=0,e=$(window).scrollTop();e>=$("#contact").position().top-68?i=3:e>=$("#about").position().top-68?i=2:e>=$("#work").position().top-68&&(i=1),i!==n&&($("#header-menu li").removeClass("selected"),$("#header-menu li:eq("+i+")").addClass("selected"),n=i)});var a=new l.controls.TouchSlider($("#work-slides"),{enableArrowKeys:!0,onSlidePositionChanged:function(t){var i=t.index,e=t.percent,s=i,o=i+1,n=$(".slide-item-overlay:eq("+o+")"),a=$(".slide-item-overlay:eq("+s+")"),l=n.data("speed"),r=a.data("speed");r=r||1,l=l||1;var h=-1*e/2,d=(1-e)/2;s!==o&&(d*=800*l,h*=800*r,n.css({webkitTransform:"matrix(1,0,0,1,"+d+",0)",mozTransform:"matrix(1,0,0,1,"+d+",0)",transform:"matrix(1,0,0,1,"+d+",0)"}),a.css({webkitTransform:"matrix(1,0,0,1,"+h+",0)",mozTransform:"matrix(1,0,0,1,"+h+",0)",transform:"matrix(1,0,0,1,"+h+",0)"}))},onSlideTap:function(t){!function(t){o(!1),a.isEnabled=!1;var i=e[t];i.slider.moveToSlide(0,0,null),i.slider.toggleArrowKeys(!0),e[t].show(function(){a.isEnabled=!0,i.slider.toggleArrowKeys(!1),o(!0)})}(t)},onSlideChanged:function(s){$("#slides-prev").toggleClass("disabled",0===s),$("#slides-next").toggleClass("disabled",s===this.slideCount-1),$("#work-slides-counter-current").stop().animate({top:-15,opacity:0},{duration:150,easing:"easeInOutQuart",complete:function(){var t,i,e;$(this).text((t=s+1,i=2,e="000"+t,e.substr(e.length-i))).css({top:15}).delay(10).stop().animate({top:0,opacity:1},{duration:150,easing:"easeInOutQuart"})}})}});function i(){$("#work-slides-dropdown").fadeOut(100),$("#work-slides-dropdown-overlay").hide().off("pxtap")}$("#work-slides-counter").on("pxtap",function(){$("#work-slides-dropdown").fadeIn(200),$("#work-slides-dropdown-overlay").show().on("pxtap",i)}),$(".work-slides-dropdown-item").on("click",function(){var t=$(this).index();a.moveToSlide(t),setTimeout(function(){i()},10)}),$("#work-slides").on({mousemove:function(t){var i=t.pageX/$(this).width(),e=1-i,s=i;$("#slides-next").css("opacity",s),$("#slides-prev").css("opacity",e)},mouseenter:function(){$("#slides-next, #slides-prev").addClass("show")},mouseleave:function(){$("#slides-next, #slides-prev").removeClass("show")}}),$("#slides-next").on("click",function(){a.next()}),$("#slides-prev").on("click",function(){a.prev()}),$(".detail-item").each(function(){var t=new l.controls.WorkDetail($(this));e.push(t)}),$(".work-detail-slides-navselector li").click(function(t){var i=$(this).index()+1;$(this).closest(".work-detail-item").find(".work-detail-slides-outer").iosSlider("goToSlide",i)}),$(".question-item").has(".more").addClass("hasmore"),$('<span class="prompt">MORE</span>').insertBefore(".question-item .more:first-child"),$(".question-item.hasmore").click(function(){$(this).removeClass("hasmore"),$(this).find(".more").css({opacity:0}).animate({opacity:1},300)}),$("#contact-form").submit(function(){var t=$(this).attr("action");return $("#submit").attr("disabled","disabled"),$.post(t,{name:$("#name").val(),email:$("#email").val(),phone:$("#phone").val(),subject:$("#subject").val(),comments:$("#comments").val(),verify:$("#verify").val()},function(t){var i;"SUCCESS"===t?($("#contact-form").animate({left:"1000px",opacity:"0"},600,"easeInBack",function(){$("#contact-form").css("opacity",0),$("#contact-sent").fadeIn(400).delay(1600).fadeOut(400),$("#contact-form").css("left","-200px").delay(2e3).animate({left:"0",opacity:"1"},1e3,"easeInQuart")}),$("#name").val(""),$("#email").val(""),$("#phone").val(""),$("#subject").val(""),$("#comments").val(""),$("#verify").val("")):(i=t,$("#contact-form #message").html(i).fadeIn(200).delay(2e3).fadeOut(500)),$("#submit").removeAttr("disabled")}),!1});var t=function(){var t=$(window).width();l.view.isMobile=t<529,l.view.isTablet=529<t&&t<=949,l.view.isDesktop=949<t,$.each(e,function(t,i){i.slider.isEnabled=l.view.isDesktop})};$(window).resize(t),t()}()}();